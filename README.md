# sro10
import pandas as pd

# Создание фрейма данных для банка
банковские_данные = {
    'ИД_Клиента': [1, 2, 3, 4, 5],
    'Имя': ['Иван', 'Алиса', 'Боб', 'Ева', 'Чарли'],
    'Фамилия': ['Иванов', 'Смирнова', 'Джонсон', 'Вонг', 'Браун'],
    'Пол': ['М', 'Ж', 'М', 'Ж', 'М'],
    'Возраст': [25, 30, 22, 35, 28],
    'ИД_Счета': [101, 102, 103, 104, 105],
    'Баланс': [5000.50, 12000.75, 800.20, 30000.00, 1500.30],
    'Тип_Счета': ['Сберегательный', 'Текущий', 'Сберегательный', 'Текущий', 'Сберегательный'],
    'ИД_Транзакции': [1001, 1002, 1003, 1004, 1005],
    'Сумма': [100.50, 500.25, -20.30, 1000.00, -50.75],
    'Дата_Транзакции': ['2023-01-01', '2023-02-15', '2023-03-10', '2023-04-05', '2023-05-20']
}

банковский_фрейм = pd.DataFrame(банковские_данные)

# Распечатка фрейма данных банка
print(банковский_фрейм)
#3
# Предположим, что у нас уже есть фрейм данных банка (банковский_фрейм)
def средний_баланс(df):
    """Вычисляет средний баланс по всем счетам."""
    return df['Баланс'].mean()

def количество_транзакций(df):
    """Возвращает общее количество транзакций в фрейме данных."""
    return len(df)

def топ_клиенты(df, n=3):
    """Возвращает топ n клиентов по суммарному балансу."""
    top_clients = df.groupby('ИД_Клиента')['Баланс'].sum().sort_values(ascending=False).head(n)
    return top_clients

# Пример использования функций
средний_баланс = средний_баланс(банковский_фрейм)
print(f"Средний баланс по всем счетам: {средний_баланс}")

количество_транзакций = количество_транзакций(банковский_фрейм)
print(f"Общее количество транзакций: {количество_транзакций}")

топ_клиенты = топ_клиенты(банковский_фрейм)
print("Топ клиентов по суммарному балансу:")
print(топ_клиенты)
import pandas as pd
import pandas as pd

import pandas as pd

# Создание фрейма данных на основе предоставленных данных
банковские_данные = {
    'ИД_Клиента': [1, 2, 3, 4, 5, 6],  # Изменен ИД_Клиента
    'Имя': ['Иван', 'Алиса', 'Боб', 'Ева', 'Чарли', 'Джон'],  # Изменено Имя
    'Фамилия': ['Иванов', 'Смирнова', 'Джонсон', 'Вонг', 'Браун', 'Смит'],  # Изменена Фамилия
    'Пол': ['М', 'Ж', 'М', 'Ж', 'М', 'М'],
    'Возраст': [25, 30, 22, 35, 28, 30],  # Изменен Возраст
    'ИД_Счета': [101, 102, 103, 104, 105, 106],  # Изменен ИД_Счета
    'Баланс': [5000.50, 12000.75, 800.20, None, 1500.30, 2000.00],  # Изменено пропущенное значение в Балансе
    'Тип_Счета': ['Сберегательный', 'Текущий', 'Сберегательный', 'Текущий', 'Сберегательный', 'Текущий'],
    'ИД_Транзакции': [1001, 1002, 1003, 1004, 1005, 1006],  # Изменен ИД_Транзакции
    'Сумма': [100.50, 500.25, -20.30, 1000.00, -50.75, 150.00],  # Изменено Сумма
    'Дата_Транзакции': ['2023-01-01', '2023-02-15', '2023-03-10', '2023-04-05', '2023-05-20', '2023-06-01']  # Изменена Дата_Транзакции
}

банковский_фрейм = pd.DataFrame(банковские_данные)

# Добавление дубликатов
банковский_фрейм = pd.concat([банковский_фрейм] * 2, ignore_index=True)

# Пропущенные данные в Балансе
банковский_фрейм.at[3, 'Баланс'] = 3000.00

# Удаление дубликатов
банковский_фрейм = банковский_фрейм.drop_duplicates()

# Заполнение пропущенных значений в столбце "Баланс" средним значением
банковский_фрейм['Баланс'].fillna(банковский_фрейм['Баланс'].mean(), inplace=True)

# Вывод обновленного фрейма данных
print(банковский_фрейм)
